---
import Layout from '../layouts/Layout.astro';
import ProjectCard from '../components/cards/ProjectCard.astro';

// Define categories with proper ordering
const categories = [
  { id: 'all', name: 'All Projects', icon: '📂' },
  { id: 'data-analysis', name: 'Data Analysis', icon: '📊' },
  { id: 'web-development', name: 'Web Development', icon: '🌐' },
  { id: 'machine-learning', name: 'Machine Learning', icon: '🤖' },
  { id: 'system-admin', name: 'System Administration', icon: '⚙️' }
];

// Group projects by category for better organization
const projects = [
  {
    "title": "SpaceX Falcon 9 Landing Prediction",
    "description": "Predicted SpaceX Falcon 9 rocket landing success based on various flight parameters.",
    "technologies": ["Python", "Pandas", "NumPy", "SQL", "Machine Learning", "Logistic Regression", "SVM", "KNN", "Decision Tree"],
    "imageUrl": "/images/projects/spacex-falcon9.jpg",
    "githubUrl": "https://github.com/kb546/DataScience_Capstone_Project",
    "liveUrl": "https://github.com/kb546/DataScience_Capstone_Project",
    "category": "machine-learning"
  },
  {
    "title": "Social Buzz Data Analytics Project",
    "description": "Analyzed social media content trends, user engagement, and post performance for Social Buzz.",
    "technologies": ["Excel", "Data Cleaning", "VLOOKUP", "Pivot Tables", "Data Visualization"],
    "imageUrl": "/images/projects/social-analytics.jpg",
    "githubUrl": "https://github.com/kb546/Social_Buzz_Data_Analytics_Project",
    "liveUrl": "https://github.com/kb546/Social_Buzz_Data_Analytics_Project",
    "category": "data-analysis"
  },
  {
    "title": "Sales and Customer Performance Tableau Dashboard",
    "description": "Created interactive Tableau dashboards for tracking sales, customer trends, and KPIs.",
    "technologies": ["Tableau", "Data Visualization", "Sales Analysis", "Customer Segmentation"],
    "imageUrl": "/images/projects/tableau-dashboard.jpg",
    "githubUrl": "https://bit.ly/4eixeo2",
    "liveUrl": "https://bit.ly/4eixeo2",
    "category": "data-analysis"
  },
  {
    "title": "Healthcare Data Analysis Power BI Dashboard",
    "description": "Built an interactive Power BI dashboard to visualize patient satisfaction, demographics, and healthcare performance metrics.",
    "technologies": ["Power BI", "Healthcare Analytics", "Interactive Dashboards", "Data Analysis", "Data Cleaning"],
    "imageUrl": "/images/projects/healthcare-dashboard.jpg",
    "githubUrl": "https://github.com/kb546/Healthcare_Data_Analysis_PowerBI",
    "liveUrl": "https://github.com/kb546/Healthcare_Data_Analysis_PowerBI",
    "category": "data-analysis"
  },
  {
    "title": "CampConnect - Smart Camping Tent",
    "description": "Led a team to design and prototype a smart camping tent with integrated solar panels for eco-friendly power.",
    "technologies": ["React.js", "Firebase", "Web Development", "IoT"],
    "imageUrl": "/images/projects/smart-tent.jpg",
    "githubUrl": "https://github.com/kb546/CampConnect-Smart-Camping-Tent",
    "liveUrl": "https://github.com/kb546/CampConnect-Smart-Camping-Tent",
    "category": "web-development"
  },
  {
    "title": "RIT iSchool Web Service Consumption with React.js",
    "description": "Developed a web application using React.js to interact with the RIT iSchool website API.",
    "technologies": ["React.js", "API Integration", "Web Development", "JavaScript"],
    "imageUrl": "/images/projects/react-web-service.jpg",
    "githubUrl": "https://github.com/kb546/Project-2-React",
    "liveUrl": "https://github.com/kb546/Project-2-React",
    "category": "web-development"
  },
  {
    "title": "Responsive Replica of Dubai Expo 2020 Website",
    "description": "Designed and developed a responsive replica of the Dubai Expo 2020 website to guide tourists around the event.",
    "technologies": ["HTML", "CSS", "JavaScript", "Responsive Design"],
    "imageUrl": "/images/projects/dubai-expo.jpg",
    "githubUrl": "https://people.rit.edu/~kb5703/240/homepage/project.html",
    "liveUrl": "https://people.rit.edu/~kb5703/240/homepage/project.html",
    "category": "web-development"
  },
  {
    "title": "House Sales Prediction in Washington, USA",
    "description": "Utilized Python for data cleaning and feature engineering to predict housing prices.",
    "technologies": ["Python", "Data Analysis", "Machine Learning", "Linear Regression", "Ridge Regression"],
    "imageUrl": "/images/projects/house-prediction.jpg",
    "githubUrl": "https://github.com/kb546/House-Sales-Prediction-Project",
    "liveUrl": "https://github.com/kb546/House-Sales-Prediction-Project",
    "category": "data-analysis"
  },
  {
    "title": "System Administration Project",
    "description": "Deployed and managed a Linux virtual machine to provide web services, with security measures and regular updates.",
    "technologies": ["Linux", "Apache2", "DHCP", "SSH", "System Administration"],
    "imageUrl": "/images/projects/system-admin.jpg",
    "githubUrl": "https://github.com/kb546/System-Administration-Project",
    "liveUrl": "https://github.com/kb546/System-Administration-Project",
    "category": "system-admin"
  }
].sort((a, b) => {
  // Ensure consistent ordering within categories
  if (a.category === b.category) {
    return a.title.localeCompare(b.title);
  }
  return a.category.localeCompare(b.category);
});
---

<Layout title="Projects - Bill Kamanzi">
  <div class="pt-16">
    <section class="py-20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h1 class="text-4xl font-bold text-gray-900 mb-4">Projects</h1>
          <p class="text-lg text-gray-600 max-w-2xl mx-auto">
            A showcase of my work in data science, web development, and software engineering.
          </p>
        </div>
        
        <!-- Category Filter -->
        <div class="flex flex-wrap justify-center gap-3 mb-12">
          {categories.map(category => (
            <button
              class="category-btn px-4 py-2 rounded-lg text-sm font-medium
                     bg-white border border-gray-200 shadow-sm
                     hover:border-primary-200 hover:bg-primary-50/40
                     transition-all duration-300 ease-in-out"
              data-category={category.id}
              aria-selected={category.id === 'all'}
            >
              <span class="flex items-center gap-2">
                <span class="text-lg">{category.icon}</span>
                <span>{category.name}</span>
              </span>
            </button>
          ))}
        </div>

        <!-- Projects Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="projects-grid">
          {projects.map((project, index) => (
            <div 
              class="project-card opacity-0 transform translate-y-4" 
              data-category={project.category}
              style={`transition-delay: ${index * 50}ms`}
            >
              <ProjectCard {...project} />
            </div>
          ))}
        </div>
      </div>
    </section>
  </div>
</Layout>

<script>
  function setupProjectFiltering() {
    const buttons = document.querySelectorAll('.category-btn');
    const projectCards = document.querySelectorAll('.project-card');
    let currentCategory = 'all';

    function animateCards(show = true) {
      projectCards.forEach((card, index) => {
        setTimeout(() => {
          if (show) {
            card.classList.remove('opacity-0', 'translate-y-4');
          } else {
            card.classList.add('opacity-0', 'translate-y-4');
          }
        }, index * 50);
      });
    }

    function filterProjects(category: string) {
      if (category === currentCategory) return;
      
      currentCategory = category;
      
      // First, fade out all cards
      projectCards.forEach(card => {
        card.classList.add('opacity-0', 'translate-y-4');
      });

      // Wait for fade out animation
      setTimeout(() => {
        projectCards.forEach(card => {
          const shouldShow = category === 'all' || card.dataset.category === category;
          card.classList.toggle('hidden', !shouldShow);
        });

        // Then fade in visible cards with stagger
        requestAnimationFrame(() => {
          const visibleCards = document.querySelectorAll('.project-card:not(.hidden)');
          visibleCards.forEach((card, index) => {
            setTimeout(() => {
              card.classList.remove('opacity-0', 'translate-y-4');
            }, index * 50);
          });
        });
      }, 300);
    }

    buttons.forEach(button => {
      button.addEventListener('click', () => {
        buttons.forEach(btn => btn.setAttribute('aria-selected', 'false'));
        button.setAttribute('aria-selected', 'true');
        
        const category = button.dataset.category;
        if (category) filterProjects(category);
      });
    });

    // Initial animation
    requestAnimationFrame(() => {
      animateCards(true);
    });
  }

  // Setup on initial load and view transitions
  setupProjectFiltering();
  document.addEventListener('astro:page-load', setupProjectFiltering);
</script>

<style>
  .project-card {
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .category-btn {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .category-btn[aria-selected="true"] {
    @apply bg-primary-50 border-primary-200 text-primary-700 transform -translate-y-0.5;
  }

  .hidden {
    display: none;
  }
</style>